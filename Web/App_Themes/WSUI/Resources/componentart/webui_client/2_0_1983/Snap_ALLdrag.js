var qztd=false,qzrv,qzbz=null,qzbw=null,qzpt,qzps,qzvo,qzlv,art_oldDownHandler,qzva,qzxp;function art_InitDraggable(qzro,qzyu,qzAjz){var qzg=art_GetInstance(qzro);qzg.qztf=(qzyu=='FreeStyle'||qzyu=='Horizontal');qzg.qzvp=(qzyu=='FreeStyle'||qzyu=='Vertical');qzg.qzik=qzAjz;};function qxc(qzim,qzgx){qzic=false;qzmg=null;qzlx=-1;qzrv=false;if(qzow){qzim.cancelBubble=true;}else{qzim.preventDefault();qzim.stopPropagation();};var qzg=qzgx,qzq=qzg.Frame;qzbw=qzg;var qzdv=qzg.qzdv;if(!qzdv){qzdv=new Array();qzg.qzdv=qzdv;};qzvo=qzg.qzik;qzlv=qzg.qznp;if(qzg.BringToTopOnClick){qzgq++;qzq.style.zIndex=qzgq;};if(qzow){qzpt=qztz(qzim,qzq);qzps=qzty(qzim,qzq);}else if(qzAjl){qzpt=qzim.offsetX;qzps=qzim.offsetY;}else{qzpt=qzim.layerX;qzps=qzim.layerY;};if(qzg.qzAbc){qzAej(qzdv);};qzmi(qzg);art_oldDownHandler=document.onmousedown;qzva=document.onmousemove;qzxp=document.onmouseup;document.onmousedown=ComponentArt_CancelEvent;document.onmousemove=qzAlf;document.onmouseup=qzAiz;return false;};function qzAlf(qzim){if(qzow){event.cancelBubble=true;}else{qzim.preventDefault();qzim.stopPropagation();};if(!qzrv){qzrv=true;qztd=true;qzbz=qzAih(qzbw,qzvo,qzlv);if(qzbz==qzbw.Frame&&qzbw.qzms){qzAfg(art_dragInstanceId,qzmh(qzbw.Frame),qzhf(qzbw.Frame));};if(qzvo=='Original'){qzbw.Frame.style.visibility='hidden';};};var qzp,qzf;if(qzow){qzp=event.clientX+document.body.scrollLeft;qzf=event.clientY+document.body.scrollTop;}else{qzp=qzim.pageX;qzf=qzim.pageY;};if(!qzbw.qztf){qzp=qzmh(qzbz)+parseInt(qzbz.style.width)/2;};if(!qzbw.qzvp){qzf=qzhf(qzbz)+parseInt(qzbz.style.height)/2;};if(qzbw.qzAbc){var qzAgq=false;for(var qzba=0;qzba<qzbr.length;qzba++){if(qzf>qzkm[qzba]&&qzf<qzkm[qzba]+qzpu[qzba]&&qzp>qzhe[qzba]&&qzp<qzhe[qzba]+qzno[qzba]){var qzcf=qzAbr(qzbz,qzbr[qzba],qzp,qzf);if((!qzic||qzmg!=qzbr[qzba]||qzlx!=qzcf)){if(qzlv=='Original'){qxa(qzbw.Id,qzbr[qzba],qzcf);}else{qzAfd(qzbw,qzba,qzcf);};qzmg=qzbr[qzba];qzlx=qzcf;qzic=true;};qzAgq=true;break;};};if(!qzAgq){qzyt(qzbw);qzic=false;};};var qzze=qzp-qzpt,qzzd=qzf-qzps;if(qzbw.qztf){qzbz.style.left=qzze;};if(qzbw.qzvp){qzbz.style.top=qzzd;};qzgb(qzbw,qzze,qzzd,qzbz.offsetWidth,qzbz.offsetHeight);return false;};function qzAiz(qzim){qztd=false;document.onmousedown=art_oldDownHandler;document.onmousemove=qzva;document.onmouseup=qzxp;if(!qzrv){return false;};var qzq=qzbw.Frame,qzxo=qzmh(qzbz),qzxn=qzhf(qzbz);if(qzbz!=qzq){qzAdu(qzbz);};qzAfe(qzbw,qzxo,qzxn);qzym();qzq.style.visibility='visible';qzq.style.visibility='';qzjg(qzbw);return false;};function qzAfe(qzg,qzxo,qzxn){var qzq=qzg.Frame;if(qzg.qzAcg&&!qzic){if(qzg.qzms){return false;}else if(qzg.qzpv){qxa(qzg.Id,qzg.qzpv,qzg.qzvq);return false;};};if(qzg.qzms){qzAfg(qzg,qzxo,qzxn);}else{qzq.style.left=qzxo;qzq.style.top=qzxn;};if(qzic){var qzbs=document.getElementById(qzmg);if(qzlx>qzbs.childNodes.length){qzlx=qzbs.childNodes.length;};qxa(qzg.Id,qzmg,qzlx);}else{qzq.style.height=qzg.qznq;qzq.style.height='';qzq.style.width=qzg.qzpf;if(qzg.qzlb){if(qzg.FloatAlignment=='Default'){var qzkh=window.document.body.scrollLeft,qzlz=window.document.body.scrollTop;qzg.qzqg=qzxo-qzkh;qzg.qzqf=qzxn-qzlz;};art_RepositionFloater(qzg);};};};function qzAfd(qzg,qzka,qzcf){var qzAcd=false,qzak=qzg.qzak;if(qzak!=null){qzyt(qzg);qzak=qzg.qzak;};if(qzak==null){qzak=document.createElement('div');qzak.style.position='absolute';qzak.style.fontSize='1px';qzak.style.visibility='hidden';qzAcd=true;};var qzbs=document.getElementById(qzbr[qzka]);if(qzg.qzms&&qzg.qzpv==qzbr[qzka]&&qzcf>=qzbs.childNodes.length){qzcf=qziv(qzbr[qzka],qzcf);};if(qzcf==-1){qzak.style.top=qzkm[qzka];qzak.style.left=qzhe[qzka];qzak.style.height=Math.min(qzbz.offsetHeight,qzpu[qzka]);qzak.style.width=qzno[qzka];}else if(qzcf>=qzbs.childNodes.length){qzcf=qziv(qzbr[qzka],qzbs.childNodes.length);var qzkf=qzbs.childNodes[qzcf],qzxm=qzhf(qzkf)+qzkf.offsetHeight,qzAlv=Math.min(qzkm[qzka]+qzpu[qzka]-qzxm,qzbz.offsetHeight);qzak.style.top=qzxm;qzak.style.left=qzhe[qzka];qzak.style.height=qzbz.offsetHeight;qzak.style.width=qzno[qzka];}else{var qzkf=qzbs.childNodes[qzcf];qzak.style.top=qzhf(qzkf);qzak.style.left=qzhe[qzka];qzak.style.height=qzkf.offsetHeight;qzak.style.width=qzno[qzka];};if(qzAcd){qzAhc(qzak,qzlv);};qzak.style.zIndex=qzgq+1;document.body.appendChild(qzak);qzak.style.visibility='visible';qzg.qzak=qzak;};function qzyt(qzg){var qzak=qzg.qzak;if(qzak!=null){if(qzlv=='TransparentRectangle'||qzlv=='Shadow'){qzAdu(qzak);qzg.qzak=null;}else{qzak.style.visibility='hidden';};};};function qzAih(qzg,qzik,qznp){var qzq=qzg.Frame;if(qzik=='Original'&&qznp=='Original')return qzq;var qzdd=document.createElement("DIV");qzdd.style.position='absolute';qzdd.style.left=qzmh(qzq);qzdd.style.top=qzhf(qzq);qzdd.style.height=qzq.offsetHeight;qzdd.style.width=qzq.offsetWidth;qzdd.style.zIndex=qzgq+1;switch(qzik){case'SolidOutline':qzdd.style.borderStyle='solid';qzdd.style.borderWidth=2;document.body.appendChild(qzdd);qzdd.style.visibility='visible';break;case'DashedOutline':qzdd.style.borderStyle='dashed';qzdd.style.borderWidth=1;qzdd.style.borderColor='#ffffff';var qzeu=document.createElement('div');qzeu.style.borderWidth=1;qzeu.style.borderColor='#000000';qzeu.style.borderStyle='dashed';qzeu.style.width='100%';qzeu.style.height='100%';qzdd.appendChild(qzeu);document.body.appendChild(qzdd);qzdd.style.visibility='visible';break;case'GhostCopy':var qzct=qzq.cloneNode(true);qzct.id='tempDrag_'+qzg.Id;if(qzow){qzct.style.filter='alpha(opacity=50)';}else{qzct.style.opacity=0.5;qzct.style.setProperty('-moz-opacity',0.5,"");};qzct.style.position='absolute';qzct.style.top=0;qzct.style.left=0;qzct.style.height='100%';qzct.style.width='100%';if(qzg.RenderOverWindowedObjects){var qzuz=qzxt(qzct);if(qzuz){qzct.removeChild(qzuz);};};qzdd.appendChild(qzct);document.body.appendChild(qzdd);break;case'Original':var qzct=qzq.cloneNode(true);qzct.id='tempDrag_'+qzg.Id;qzct.style.position='absolute';qzct.style.top=0;qzct.style.left=0;qzct.style.height='100%';qzct.style.width='100%';if(qzg.RenderOverWindowedObjects){var qzuz=qzxt(qzct);if(qzuz){qzct.removeChild(qzuz);};};qzdd.appendChild(qzct);document.body.appendChild(qzdd);break;case'TransparentRectangle':qzAch(qzdd,'#000000','#505050');document.body.appendChild(qzdd);break;case'Shadow':qzAab(qzdd,'#202020');document.body.appendChild(qzdd);break;default:qzdd.style.display='none';document.body.appendChild(qzdd);break;};if(qzow&&qzg.RenderOverWindowedObjects&&(qzik=='Shadow'||qzik=='GhostCopy'||qzik=='TransparentRectangle')){var qztc=document.createElement('iframe');qztc.style.position='absolute';qztc.style.top=0;qztc.style.left=0;qztc.style.width='100%';qztc.style.height='100%';qztc.style.display='block';qztc.style.zIndex=-1;if(qzow){qztc.style.filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';}else{qzct.style.opacity=0;qzct.style.setProperty('-moz-opacity',0,"");};qzdd.appendChild(qztc);};return qzdd;};
